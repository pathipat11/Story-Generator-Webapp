<!doctype html>
<html lang="th" class="h-full">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Story Generator (Gemini)</title>

    <!-- Tailwind CDN (Demo-friendly) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Enable class-based dark mode
        tailwind.config = { darkMode: 'class' };
    </script>

    <script defer src="/static/app.js"></script>

    <script>
        // Apply theme ASAP to avoid flash
        (function () {
            const saved = localStorage.getItem("theme");
            const prefersDark = window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches;
            const theme = saved || (prefersDark ? "dark" : "light");
            document.documentElement.classList.toggle("dark", theme === "dark");
        })();
    </script>
</head>

<body class="h-full bg-slate-50 text-slate-900 dark:bg-slate-950 dark:text-slate-100">
    <div class="min-h-full">
        <!-- Top bar -->
        <header
            class="sticky top-0 z-10 border-b border-slate-200/70 bg-white/70 backdrop-blur dark:border-slate-800 dark:bg-slate-950/60">
            <div class="mx-auto flex max-w-6xl items-center justify-between px-4 py-3">
                <div class="flex items-center gap-3">
                    <div
                        class="h-9 w-9 rounded-xl bg-slate-900 text-white grid place-items-center dark:bg-white dark:text-slate-900">
                        ‚ú¶
                    </div>
                    <div>
                        <div class="text-lg font-semibold leading-tight">Story Generator</div>
                        <div class="text-xs text-slate-500 dark:text-slate-400">Gemini ‚Ä¢ Create story + chapters +
                            downloads</div>
                    </div>
                </div>

                <div class="flex items-center gap-3">
                    <span id="storyBadge"
                        class="hidden sm:inline-flex rounded-full border border-slate-200 px-3 py-1 text-xs text-slate-600 dark:border-slate-800 dark:text-slate-300">
                        story_id: -
                    </span>

                    <button id="themeToggle"
                        class="inline-flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-200 dark:hover:bg-slate-800">
                        <span id="themeIcon">üåô</span>
                        <span class="hidden sm:inline">Toggle</span>
                    </button>
                </div>
            </div>
        </header>

        <main class="mx-auto max-w-6xl px-4 py-6">
            <div class="grid grid-cols-1 gap-5 lg:grid-cols-2">
                <!-- Left: Controls -->
                <section
                    class="rounded-2xl border border-slate-200 bg-white p-5 shadow-sm dark:border-slate-800 dark:bg-slate-900">
                    <div class="flex items-center justify-between">
                        <h2 class="text-base font-semibold">Options</h2>
                        <label class="inline-flex items-center gap-2 text-sm text-slate-600 dark:text-slate-300">
                            <input id="wantImgPrompt" type="checkbox" checked
                                class="h-4 w-4 rounded border-slate-300 text-slate-900 focus:ring-slate-400 dark:border-slate-700 dark:bg-slate-950" />
                            Illustration prompt
                        </label>
                    </div>

                    <div class="mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2">
                        <div>
                            <label class="text-xs font-medium text-slate-600 dark:text-slate-300">Genre</label>
                            <select id="genre"
                                class="mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-300 dark:border-slate-800 dark:bg-slate-950 dark:focus:ring-slate-700">
                                <option value="fantasy">‡πÅ‡∏ü‡∏ô‡∏ï‡∏≤‡∏ã‡∏µ</option>
                                <option value="adventure">‡∏ú‡∏à‡∏ç‡∏†‡∏±‡∏¢</option>
                                <option value="detective">‡∏™‡∏∑‡∏ö‡∏™‡∏ß‡∏ô</option>
                                <option value="slice">‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</option>
                                <option value="bedtime">‡∏ô‡∏¥‡∏ó‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≠‡∏ô</option>
                            </select>
                        </div>

                        <div>
                            <label class="text-xs font-medium text-slate-600 dark:text-slate-300">Tone</label>
                            <select id="tone"
                                class="mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-300 dark:border-slate-800 dark:bg-slate-950 dark:focus:ring-slate-700">
                                <option value="warm">‡∏≠‡∏ö‡∏≠‡∏∏‡πà‡∏ô</option>
                                <option value="funny">‡∏ï‡∏•‡∏Å</option>
                                <option value="mystery">‡∏•‡∏∂‡∏Å‡∏•‡∏±‡∏ö</option>
                                <option value="dark_soft">‡∏î‡∏≤‡∏£‡πå‡∏Å‡πÅ‡∏ö‡∏ö‡πÄ‡∏ö‡∏≤</option>
                            </select>
                        </div>

                        <div>
                            <label class="text-xs font-medium text-slate-600 dark:text-slate-300">Target age</label>
                            <select id="age"
                                class="mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-300 dark:border-slate-800 dark:bg-slate-950 dark:focus:ring-slate-700">
                                <option value="kids">‡πÄ‡∏î‡πá‡∏Å‡πÄ‡∏•‡πá‡∏Å</option>
                                <option value="preteens">‡πÄ‡∏î‡πá‡∏Å‡πÇ‡∏ï</option>
                                <option value="teens">‡∏ß‡∏±‡∏¢‡∏£‡∏∏‡πà‡∏ô</option>
                                <option value="adult">‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà</option>
                            </select>
                        </div>

                        <div>
                            <label class="text-xs font-medium text-slate-600 dark:text-slate-300">Length</label>
                            <select id="length"
                                class="mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-300 dark:border-slate-800 dark:bg-slate-950 dark:focus:ring-slate-700">
                                <option value="short">‡∏™‡∏±‡πâ‡∏ô</option>
                                <option value="medium">‡∏Å‡∏•‡∏≤‡∏á</option>
                                <option value="long">‡∏¢‡∏≤‡∏ß</option>
                            </select>
                        </div>
                    </div>

                    <div class="mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2">
                        <div class="sm:col-span-1">
                            <label class="text-xs font-medium text-slate-600 dark:text-slate-300">Setting</label>
                            <input id="setting" value="‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡πá‡∏Å‡πÜ‡πÉ‡∏Å‡∏•‡πâ‡∏õ‡πà‡∏≤"
                                class="mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-300 dark:border-slate-800 dark:bg-slate-950 dark:focus:ring-slate-700" />
                        </div>
                        <div class="sm:col-span-1">
                            <label class="text-xs font-medium text-slate-600 dark:text-slate-300">Theme / Moral</label>
                            <input id="theme" value="‡∏°‡∏¥‡∏ï‡∏£‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°"
                                class="mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-300 dark:border-slate-800 dark:bg-slate-950 dark:focus:ring-slate-700" />
                        </div>
                    </div>

                    <!-- Characters -->
                    <div class="mt-5">
                        <div class="flex items-center justify-between">
                            <h3 class="text-sm font-semibold">Characters</h3>
                            <button id="addChar" type="button"
                                class="rounded-xl bg-slate-900 px-3 py-2 text-sm font-medium text-white hover:bg-slate-800 dark:bg-white dark:text-slate-900 dark:hover:bg-slate-200">
                                + Add
                            </button>
                        </div>
                        <div id="chars" class="mt-3 space-y-3"></div>
                        <p class="mt-2 text-xs text-slate-500 dark:text-slate-400">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô ‡πÄ‡∏ä‡πà‡∏ô
                            ‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏Å/‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô/‡∏ï‡∏±‡∏ß‡∏£‡πâ‡∏≤‡∏¢</p>
                    </div>

                    <!-- Relationships -->
                    <div class="mt-4">
                        <label class="text-xs font-medium text-slate-600 dark:text-slate-300">Relationships
                            (optional)</label>
                        <textarea id="rels"
                            placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏∞‡∏•‡∏¥‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡∏ï‡πâ‡∏ô‡∏ô‡πâ‡∏≥ / ‡∏ï‡∏±‡∏ß‡∏£‡πâ‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏±‡∏ô‡∏î‡∏≥‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏î‡πâ‡∏Ç‡∏≠‡∏á‡∏ß‡∏¥‡πÄ‡∏®‡∏©..."
                            class="mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-300 dark:border-slate-800 dark:bg-slate-950 dark:focus:ring-slate-700"
                            rows="3"></textarea>
                    </div>

                    <!-- Idea -->
                    <div class="mt-4">
                        <label class="text-xs font-medium text-slate-600 dark:text-slate-300">Story idea</label>
                        <textarea id="idea" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏û‡∏•‡πá‡∏≠‡∏ï/‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡πÉ‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á..."
                            class="mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-300 dark:border-slate-800 dark:bg-slate-950 dark:focus:ring-slate-700"
                            rows="5"></textarea>
                    </div>

                    <!-- Actions -->
                    <div class="mt-4 flex flex-col gap-3">
                        <div class="flex flex-wrap gap-2">
                            <button id="gen" type="button"
                                class="rounded-xl bg-slate-900 px-4 py-2 text-sm font-semibold text-white hover:bg-slate-800 dark:bg-white dark:text-slate-900 dark:hover:bg-slate-200">
                                Generate story
                            </button>

                            <button id="next" type="button" disabled
                                class="rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-700 shadow-sm hover:bg-slate-50 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-950 dark:text-slate-200 dark:hover:bg-slate-900">
                                Next chapter
                            </button>

                            <input id="dir" placeholder="‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏ï‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ (optional)"
                                class="flex-1 min-w-[240px] rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-300 dark:border-slate-800 dark:bg-slate-950 dark:focus:ring-slate-700" />
                        </div>

                        <div class="flex flex-wrap gap-2">
                            <button id="dlMd" type="button" disabled
                                class="rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-700 shadow-sm hover:bg-slate-50 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-950 dark:text-slate-200 dark:hover:bg-slate-900">
                                Download .md
                            </button>
                            <button id="dlTxt" type="button" disabled
                                class="rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-700 shadow-sm hover:bg-slate-50 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-950 dark:text-slate-200 dark:hover:bg-slate-900">
                                Download .txt
                            </button>
                            <button id="dlPdf" type="button" disabled
                                class="rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-700 shadow-sm hover:bg-slate-50 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-950 dark:text-slate-200 dark:hover:bg-slate-900">
                                Download .pdf
                            </button>
                        </div>

                        <p class="text-xs text-slate-500 dark:text-slate-400">
                            ‡∏ñ‡πâ‡∏≤‡πÇ‡∏î‡∏ô 429 (rate limit) ‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà
                        </p>
                    </div>
                </section>

                <!-- Right: Output -->
                <section
                    class="rounded-2xl border border-slate-200 bg-white p-5 shadow-sm dark:border-slate-800 dark:bg-slate-900">
                    <div class="flex items-center justify-between">
                        <h2 class="text-base font-semibold">Output</h2>
                        <span class="text-xs text-slate-500 dark:text-slate-400">Title / Story / Moral / Summary</span>
                    </div>

                    <div
                        class="mt-3 rounded-2xl border border-slate-200 bg-slate-50 p-4 text-sm leading-relaxed dark:border-slate-800 dark:bg-slate-950">
                        <pre id="out"
                            class="whitespace-pre-wrap font-sans text-slate-900 dark:text-slate-100">‡∏Å‡∏î Generate ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ô‡∏¥‡∏ó‡∏≤‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö</pre>
                    </div>

                    <div class="mt-5">
                        <h3 class="text-sm font-semibold">Illustration Prompt</h3>
                        <div
                            class="mt-2 rounded-2xl border border-slate-200 bg-slate-50 p-4 text-sm dark:border-slate-800 dark:bg-slate-950">
                            <pre id="imgPrompt"
                                class="whitespace-pre-wrap font-sans text-slate-700 dark:text-slate-200">(‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ)</pre>
                        </div>
                    </div>

                    <div class="mt-5">
                        <h3 class="text-sm font-semibold">Chapters</h3>
                        <div id="chapters" class="mt-2 space-y-3 text-sm text-slate-700 dark:text-slate-200">
                            <div class="text-xs text-slate-500 dark:text-slate-400">(‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ)</div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>
</body>

</html>